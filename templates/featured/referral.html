<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Settings | AFI Connect</title>
    <link rel="stylesheet" href="/css/common.css" />

    <script src="https://kit.fontawesome.com/bc49f81a82.js" crossorigin="anonymous"></script>
  </head>
  <body data-layout="page">
    <include data-include="site-header"></include>

    <div class="site-content container">
      <include data-active="featured" data-include="nav"></include>

      <main class="layout__main" id="featured" aria-labelledby="featured-title">
        <header class="page-header">
          <div class="page-header__info">
            <h1 class="page-header__title" id="featured-title">Refer a friend to AFI</h1>
          </div>
        </header>
        <div class="card">
          <div class="card__header">
            <h2 class="card__title">Referral details</h2>
          </div>
          <div class="card__body">
            <form id="afi-referral-form" novalidate>
              <input type="hidden" name="AFIMemberNumber" id="AFIMemberNumber" value="3103280" />
              <div class="form-row">
                <div class="form-group">
                  <label for="PrefixSelect" class="form-label">Prefix</label>
                  <select
                    id="PrefixSelect"
                    name="PrefixSelect"
                    class="form-control form-control--select"
                    autocomplete="honorific-prefix">
                    <option value="">Select prefix</option>
                    <option value="Mr">Mr</option>
                    <option value="Mrs">Mrs</option>
                    <option value="Miss">Miss</option>
                    <option value="Ms">Ms</option>
                    <option value="Dr">Dr</option>
                    <option value="Rank">Rank (enter custom)</option>
                  </select>
                </div>

                <div class="form-group" data-prefix-group hidden>
                  <label for="Prefix" class="form-label">Custom rank</label>
                  <input
                    type="text"
                    id="Prefix"
                    name="Prefix"
                    class="form-control"
                    autocomplete="honorific-prefix"
                    placeholder="Enter rank" />
                </div>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label for="FirstName" class="form-label">First name <span aria-hidden="true">*</span></label>
                  <input
                    type="text"
                    id="FirstName"
                    name="FirstName"
                    class="form-control"
                    autocomplete="given-name"
                    required />
                </div>

                <div class="form-group">
                  <label for="LastName" class="form-label">Last name <span aria-hidden="true">*</span></label>
                  <input
                    type="text"
                    id="LastName"
                    name="LastName"
                    class="form-control"
                    autocomplete="family-name"
                    required />
                </div>
              </div>

              <div class="form-group">
                <label for="Email" class="form-label">Email</label>
                <input type="email" id="Email" name="Email" class="form-control" autocomplete="email" />
                <div class="form-text" data-contact-hint>
                  Provide an email or phone number so we can reach your referral.
                </div>
              </div>

              <div class="form-group">
                <label for="PhoneNumber" class="form-label">Phone</label>
                <input
                  type="tel"
                  id="PhoneNumber"
                  name="PhoneNumber"
                  class="form-control"
                  autocomplete="tel"
                  inputmode="tel" />
                <div class="form-text">Include area code. Phone is required if no email is provided.</div>
              </div>

              <div class="form-group">
                <label for="Relationship" class="form-label">Relationship</label>
                <select
                  id="Relationship"
                  name="Relationship"
                  class="form-control form-control--select"
                  aria-describedby="relationship-help">
                  <option value="">Choose one</option>
                  <option value="Son/Daughter">Son/Daughter</option>
                  <option value="Other">Other</option>
                </select>
                <div class="form-text" id="relationship-help">Let us know how you are connected.</div>
              </div>

              <div class="form-group">
                <label for="Address" class="form-label">Address</label>
                <input
                  type="text"
                  id="Address"
                  name="Address"
                  class="form-control"
                  autocomplete="address-line1"
                  placeholder="Street address" />
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="City" class="form-label">City</label>
                  <input type="text" id="City" name="City" class="form-control" autocomplete="address-level2" />
                </div>

                <div class="form-group">
                  <label for="State" class="form-label">State</label>
                  <select
                    id="State"
                    name="State"
                    class="form-control form-control--select"
                    autocomplete="address-level1">
                    <option value="">Select state or territory</option>
                    <option value="AL">Alabama</option>
                    <option value="AK">Alaska</option>
                    <option value="AZ">Arizona</option>
                    <option value="AR">Arkansas</option>
                    <option value="CA">California</option>
                    <option value="CO">Colorado</option>
                    <option value="CT">Connecticut</option>
                    <option value="DE">Delaware</option>
                    <option value="DC">District of Columbia</option>
                    <option value="FL">Florida</option>
                    <option value="GA">Georgia</option>
                    <option value="HI">Hawaii</option>
                    <option value="ID">Idaho</option>
                    <option value="IL">Illinois</option>
                    <option value="IN">Indiana</option>
                    <option value="IA">Iowa</option>
                    <option value="KS">Kansas</option>
                    <option value="KY">Kentucky</option>
                    <option value="LA">Louisiana</option>
                    <option value="ME">Maine</option>
                    <option value="MD">Maryland</option>
                    <option value="MA">Massachusetts</option>
                    <option value="MI">Michigan</option>
                    <option value="MN">Minnesota</option>
                    <option value="MS">Mississippi</option>
                    <option value="MO">Missouri</option>
                    <option value="MT">Montana</option>
                    <option value="NE">Nebraska</option>
                    <option value="NV">Nevada</option>
                    <option value="NH">New Hampshire</option>
                    <option value="NJ">New Jersey</option>
                    <option value="NM">New Mexico</option>
                    <option value="NY">New York</option>
                    <option value="NC">North Carolina</option>
                    <option value="ND">North Dakota</option>
                    <option value="OH">Ohio</option>
                    <option value="OK">Oklahoma</option>
                    <option value="OR">Oregon</option>
                    <option value="PA">Pennsylvania</option>
                    <option value="RI">Rhode Island</option>
                    <option value="SC">South Carolina</option>
                    <option value="SD">South Dakota</option>
                    <option value="TN">Tennessee</option>
                    <option value="TX">Texas</option>
                    <option value="UT">Utah</option>
                    <option value="VT">Vermont</option>
                    <option value="VA">Virginia</option>
                    <option value="WA">Washington</option>
                    <option value="WV">West Virginia</option>
                    <option value="WI">Wisconsin</option>
                    <option value="WY">Wyoming</option>
                    <option value="AS">American Samoa</option>
                    <option value="GU">Guam</option>
                    <option value="MP">Northern Mariana Islands</option>
                    <option value="PR">Puerto Rico</option>
                    <option value="VI">U.S. Virgin Islands</option>
                    <option value="AA">Armed Forces Americas</option>
                    <option value="AE">Armed Forces Europe</option>
                    <option value="AP">Armed Forces Pacific</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="ReferZipCode" class="form-label">Zip code</label>
                  <input
                    type="text"
                    id="ReferZipCode"
                    name="ReferZipCode"
                    class="form-control"
                    inputmode="numeric"
                    autocomplete="postal-code"
                    maxlength="10"
                    placeholder="e.g., 78234" />
                </div>
              </div>

              <div class="form-group">
                <button type="submit" class="btn btn--primary">Submit referral</button>
              </div>
            </form>
          </div>
        </div>
      </main>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const form = document.getElementById("afi-referral-form");
        if (!form) return;

        const prefixSelect = form.querySelector("#PrefixSelect");
        const prefixGroup = form.querySelector("[data-prefix-group]");
        const prefixInput = form.querySelector("#Prefix");
        const emailInput = form.querySelector("#Email");
        const phoneInput = form.querySelector("#PhoneNumber");

        const updatePrefix = () => {
          const choice = prefixSelect.value;
          const isRank = choice === "Rank";
          if (isRank) {
            prefixGroup.hidden = false;
            prefixInput.required = true;
            prefixInput.readOnly = false;
            prefixInput.focus();
          } else {
            prefixGroup.hidden = true;
            prefixInput.required = false;
            prefixInput.readOnly = true;
            prefixInput.value = choice;
          }
        };

        const updateContactValidity = () => {
          const hasEmail = emailInput.value.trim().length > 0;
          const hasPhone = phoneInput.value.trim().length > 0;
          if (hasEmail || hasPhone) {
            emailInput.setCustomValidity("");
            phoneInput.setCustomValidity("");
          } else {
            const message = "Provide an email or phone number so we can reach your referral.";
            emailInput.setCustomValidity(message);
            phoneInput.setCustomValidity(message);
          }
        };

        prefixSelect.addEventListener("change", updatePrefix);
        emailInput.addEventListener("input", updateContactValidity);
        phoneInput.addEventListener("input", updateContactValidity);

        form.addEventListener("submit", (event) => {
          updatePrefix();
          updateContactValidity();
          if (!form.checkValidity()) {
            event.preventDefault();
            form.reportValidity();
          }
        });

        // Initialize state on load
        updatePrefix();
        updateContactValidity();
      });
    </script>
    <!-- your existing scripts -->
    <script type="module" src="/js/main.js"></script>
    <script src="/js/script.js"></script>
  </body>
</html>
